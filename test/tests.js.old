'use strict';
var request = require('supertest');
var should = require('should');

var user = {};
var book = {};
var review = {};
var comment = {};
var mytest = 'test';

describe('Pending User Tests', function(done) {

	describe('try to create a pending user with no values', function(){
		it('should return 500', function (done) {
		  request(sails.hooks.http.app)
		    .post('/invite')
		    .send()
		    .expect(400, done);
		});
	});

	describe('try to create a pending user', function() {
		it('should return 200', function(done) {
			request(sails.hooks.http.app)
				.post('/invite')
				.send(generatePendingUser(true,true,true,true))
				.expect(200, done);
		})
	});
	
})

// describe('Create Book', function(done) {

// 	describe('try to create book with no values', function(){
// 		it('should return 400', function (done) {
// 		  request(sails.hooks.http.app)
// 		    .post('/book')
// 		    .send()
// 		    .expect(400, done);
// 		});
// 	});

// 	describe('try to create book with ISBN but without a title', function(){
// 		it('should return 400', function (done) {
// 		  request(sails.hooks.http.app)
// 		    .post('/book')
// 		    .send( generateBook(false, true) )
// 		    .expect(400, done);
// 		});
// 	});

// 	describe('try to create book with a title but without ISBN', function(){
// 		it('should return 400', function (done) {
// 		  request(sails.hooks.http.app)
// 		    .post('/book')
// 		    .send( generateBook(true, false) )
// 		    .expect(400, done);
// 		});
// 	});

// 	describe('try to create a book', function(){
// 		it('should return 200', function (done) {
// 		  request(sails.hooks.http.app)
// 		    .post('/book')
// 		    .send( generateBook(true, false) )
// 		    .expect(200)
// 		    .end(function(err,res) {
// 		    	book = res.body;
// 		    	done();
// 		    });
// 		});
// 	});

// })

// describe('Create Review', function(done) {
// 	//this.timeout(3000);

// 	describe('try to create review with no values', function(){
// 		it('should return 400', function (done) {
// 		  request(sails.hooks.http.app)
// 		    .post('/review')
// 		    .send()
// 		    .expect(400, done);
// 		});
// 	});

// 	describe('try to create review with a text but no reviewer or book', function(){
// 		it('should return 400', function (done) {
// 		  request(sails.hooks.http.app)
// 		    .post('/review')
// 		    .send( generateReview(true, false, false) )
// 		    .expect(400, done);
// 		});
// 	});

// 	describe('try to create review with a text and reviewer but no book', function(){
// 		it('should return 400', function (done) {
// 		  request(sails.hooks.http.app)
// 		    .post('/review')
// 		    .send( generateReview(true, false, book.id) )
// 		    .expect(400, done);
// 		});
// 	});

// 	describe('try to create review with a text and book but no reviewer', function(){
// 		it('should return 400', function (done) {
// 		  request(sails.hooks.http.app)
// 		    .post('/review')
// 		    .send( generateReview(true, user.id, false) )
// 		    .expect(400, done);
// 		});
// 	});

// 	describe('try to create review', function(){
// 		it('should return 200', function (done) {
// 		  request(sails.hooks.http.app)
// 		    .post('/review')
// 		    .send( generateReview(true, user.id, book.id) )
// 		    .expect(200)
// 		    .end(function(err,res) {
// 		    	review = res.body;
// 		    	done();
// 		    });
// 		});
// 	});

// });

// describe('Create Comment', function(done) {

// 	describe('try to create a comment with no values', function() {
// 		it('should return 400', function(done) {
// 			request(sails.hooks.http.app)
// 			.post('/comments')
// 			.send( generateReview(false, false, false) )
// 			.expect(400, done);
// 		});
// 	});

// 	describe('try to create a comment with only a user and no text or book', function() {
// 		it('should return 400', function(done) {
// 			request(sails.hooks.http.app)
// 			.post('/comments')
// 			.send( generateReview(user.id, false, false) )
// 			.expect(400, done);
// 		});
// 	});

// 	describe('try to create a comment with only a book and no user or text', function() {
// 		it('should return 400', function(done) {
// 			request(sails.hooks.http.app)
// 			.post('/comments')
// 			.send( generateReview(false, book.id, false) )
// 			.expect(400, done);
// 		});
// 	});

// 	describe('try to create a comment with all values provided', function() {
// 		it('should return 200', function(done) {
// 			request(sails.hooks.http.app)
// 			.post('/comments')
// 			.send( generateReview(false, book.id, false) )
// 			.expect(200)
// 			.end(function(req, res) {
// 				comment = res.body;
// 				done();
// 			});
// 		});
// 	});
// 
// });


function generatePendingUser(hasName, hasEmail, hasAffiliation, hasTitle) {
	var pendingUser = {};

	if (hasName) pendingUser.name = 'Bobbie Brown';
	if (hasEmail) pendingUser.emailAddress = 'bobbie.brown@example.edu';
	if (hasAffiliation) pendingUser.affiliation = 'Very Exclusive University';
	if (hasTitle) pendingUser.title = "Assistant Professor";

	return pendingUser;
}

function generateBook(hasTitle, hasISBN) {

	var book = {};

	if ( hasTitle ) book.title = "Occidentalism";
	if ( hasISBN ) book.ISBN = '0143034871';

	return book;
}

function generateReview(hasText, hasReviewer, hasBook) {

	var review = {};

	if ( hasText ) review.text = "This is a very short review";
	if ( hasReviewer ) review.reviewer = hasReviewer;
	if ( hasBook ) review.book = hasBook;

	return review;
}

function generateComment(hasUser, hasBook, hasText) {

	var comment = {};

	if ( hasUser ) comment.user = hasUser;
	if ( hasBook ) comment.book = hasBook;
	if ( hasText ) comment.text = 'This is a very short comment';

	return comment;

};